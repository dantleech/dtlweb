{% extends "AcmeBasicCmsBundle::layout.html.twig" %}
{% block title %}
    <h1>{{ post.title }}</h1>
    <p>{% include "AcmeBasicCmsBundle:Default:_tags.html.twig" with {'tags': post.tags} %}</p>
{% endblock %}
{% block content %}
    <div class="cell">
        <div class="col width-2of4">
            <span class="icon icon-32 icon-chevron-sign-left"></span>{% include "AcmeBasicCmsBundle:Default:_postSibling.html.twig" with {'sibling': cmf_prev(post)} %}
        </div>
        <div class="col width-2of4" style="text-align: right">
            {% include "AcmeBasicCmsBundle:Default:_postSibling.html.twig" with {'sibling': cmf_next(post)} %}<span class="icon icon-32 icon-chevron-sign-right">
        </div>
    </div>
    <div class="cell">
        <section class="article">
            <div class="cell">
            {{ post.content|markdown|raw }}
            </div>
            <div class="cell" style="text-align: right">
                <i>Posted on: {{ post.date.format('Y-m-d H:i:s') }}</i>
            </div>
        </section>
        <h2>Comments</h2>
        {% for comment in post.comments %}
        <div class="cell panel">
            <div class="header">
                {{ comment.author|default('Anon.') }} said the following on the {{ comment.createdAt.format('jS F Y at g:i a') }}:
            </div>
            <div class="body">
                <div class="cell">
                    {{ comment.comment|markdown|raw }}
                </div>
            </div>
        </div>
        {% else %}
        <div class="cell">
            <p>No comments yet!</p>
        </div>
        {% endfor %}
        <h3 id="comment">Leave a comment</h3>
        <div class="cell">
                <form action="#comment" method="POST">
                <div class="col">
                    {{ form_row(comment_form.email) }}
                    {{ form_row(comment_form.notify) }}
                    {{ form_row(comment_form.author) }}
                    <div class="col">
                        <div class="col width-1of4"><div class="cell"><label>Prove yourself:</label></div></div>
                        {#
                        <div class="col width-fill">
                            {{ form_errors(comment_form.expressionAnswer) }}
                            <div class="cell">
                                <input required="yes" type="text" placeholder="Answer the following" name="form[expressionAnswer]" /><br />
                            <code>{{ expression.expression }}</code><br/>
                            {% if expression.vars|length %}
                                Where:
                                <ul>
                                {% for varName, varValue in expression.vars %}
                                    <li><b>${{ varName }}</b> = <b>{{ varValue }}</b></li>
                                {% endfor %}
                                </ul><br/>
                            {% endif %}
                        </div>
                        </div>
                        #}
                        {{ form_row(comment_form.captcha) }}
                        {{ form_widget(comment_form.expression) }}
                        {{ form_widget(comment_form.expressionVars) }}
                        {{ form_widget(comment_form._token) }}
                    </div>
                    {{ form_row(comment_form.comment) }}
                    <input type="submit"/>
                </div>
            </form>
        </div>
    </div>
{% endblock %}

